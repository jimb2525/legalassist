<?xml version="1.0" encoding="UTF-8"?><record_update table="sysauto_script">
    <sysauto_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <business_calendar/>
        <condition/>
        <conditional>false</conditional>
        <entered_time/>
        <name>3be7f1b58758c1109db5dc273cbb3538</name>
        <offset/>
        <offset_type>0</offset_type>
        <run_as display_value="System Administrator">6816f79cc0a8016401c5a33be04be441</run_as>
        <run_as_tz/>
        <run_dayofmonth>1</run_dayofmonth>
        <run_dayofweek/>
        <run_period/>
        <run_start>2021-12-12 22:40:53</run_start>
        <run_time/>
        <run_type>once</run_type>
        <script><![CDATA[/*
Created By: Deba C
Created On: Aug 20, 2020
Description: Script is to associate commitments to service offerings
*/

var commitments = [{id:'505de57c0a0a0b6100e964d67f8fa089', order:'100'}, //98% Availability 24X7, P1 Resolution 1hr 24x7 (90%)
                {id:'79571781c0a8016700fd1d03f356a45d', order:'200'}];

//var queryString = "parent=c5948f571b95009025369607bc4bcb6f^portfolio_status=catalog^service_status=operational"; //parent=Email Services
var queryString = "parent=1c12631a29742010f877fb1a7600f0ed^ORparent=c7f4684d2901a410f877fb1a7600f052^ORparent=5ff7d4852901a410f877fb1a7600f0ba^portfolio_status=catalog^service_status=operational";

var offeringGR = new GlideRecord("service_offering");
offeringGR.addEncodedQuery(queryString);
offeringGR.query();

while(offeringGR.next()) {
    gs.info('Service Offering: ' + offeringGR.getValue('name'));
    gs.info("Sys ID: " + offeringGR.getUniqueValue());

    for(j=0;j<commitments.length;j++) {
    var data = commitments[j];
    var x = new GlideRecord("service_offering_commitment");
    //check if entry akready exist
    x.addQuery('service_offering',offeringGR.sys_id);
    x.addQuery('service_commitment',data.id);
    x.query();
    if(x.getRowCount()<=0)
    {
        x.initialize();
    x.setValue("service_offering", offeringGR.sys_id);
    x.setValue("service_commitment", data.id);
    x.setValue("order", data.order);
    //if (offeringGR.name == 'Rewards Offering'){
    x.setValue("primary","true");
    //}
    //else{
    //x.setValue("primary","true");   
   // }
    x.insert();
    } // end of if
    else {
        gs.info("Not creating Commitments");
    }
    }
 
}

gs.info('Script Ends Here !!');


]]></script>
        <sys_class_name>sysauto_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-12-12 22:40:53</sys_created_on>
        <sys_id>57abf58787188d10e339c956cebb3520</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>3be7f1b58758c1109db5dc273cbb3538</sys_name>
        <sys_package display_value="Legal Assist" source="x_snc_legal_assist">5e06db671b47a0106c42337cdc4bcbc2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Legal Assist">5e06db671b47a0106c42337cdc4bcbc2</sys_scope>
        <sys_update_name>sysauto_script_57abf58787188d10e339c956cebb3520</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-12-12 22:40:53</sys_updated_on>
        <time_zone/>
        <upgrade_safe>false</upgrade_safe>
    </sysauto_script>
</record_update>
